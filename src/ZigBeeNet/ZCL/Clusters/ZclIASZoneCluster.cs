// License text here

using System;
using System.Collections.Concurrent;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;
using System.Threading.Tasks;
using ZigBeeNet.DAO;
using ZigBeeNet.ZCL.Protocol;
using ZigBeeNet.ZCL.Field;
using ZigBeeNet.ZCL.Clusters.IASZone;

namespace ZigBeeNet.ZCL.Clusters
{
    /// <summary>
    /// IAS Zonecluster implementation (Cluster ID 0x0500).
    ///
    /// The IAS Zone cluster defines an interface to the functionality of an IAS security
    /// zone device. IAS Zone supports up to two alarm types per zone, low battery
    /// reports and supervision of the IAS network.
    ///
    /// Code is auto-generated. Modifications may be overwritten!
    /// </summary>
    public class ZclIASZoneCluster : ZclCluster
    {
        /// <summary>
        /// The ZigBee Cluster Library Cluster ID
        /// </summary>
        public const ushort CLUSTER_ID = 0x0500;

        /// <summary>
        /// The ZigBee Cluster Library Cluster Name
        /// </summary>
        public const string CLUSTER_NAME = "IAS Zone";

        /* Attribute constants */

        /// <summary>
        /// The Zone State attribute defines if the device is currently enrolled with a CIE or not.
        /// </summary>
        public const ushort ATTR_ZONESTATE = 0x0000;

        /// <summary>
        /// The Zone Type dictates the meaning of Alarm1 and Alarm2 bits of the ZoneStatus attribute
        /// </summary>
        public const ushort ATTR_ZONETYPE = 0x0001;

        /// <summary>
        /// The ZoneStatus attribute is a bit map. Each bit defines the state of an alarm.
        /// </summary>
        public const ushort ATTR_ZONESTATUS = 0x0002;

        /// <summary>
        /// The IAS_CIE_Address attribute specifies the address that commands generated by
        /// the server shall be sent to. All commands received by the server must also come
        /// from this address.
        /// 
        /// It is up to the zone's specific implementation to permit or deny change (write) of
        /// this attribute at specific times. Also, it is up to the zone's specific implementation
        /// to implement some auto-detect for the CIE (example: by requesting the ZigBee
        /// cluster discovery service to locate a Zone Server cluster.) or require the
        /// intervention of a CT in order to configure this attribute during installation.
        /// </summary>
        public const ushort ATTR_IASCIEADDRESS = 0x0010;

        /// <summary>
        /// A unique reference number allocated by the CIE at zone enrollment time.
        /// 
        /// Used by IAS devices to reference specific zones when communicating with the CIE. The ZoneID of each zone stays fixed until that zone is
        /// unenrolled.
        /// </summary>
        public const ushort ATTR_ZONEID = 0x0011;

        /// <summary>
        /// Provides the total number of sensitivity levels supported by the IAS Zone server. The purpose of this attribute is to support devices that
        /// can be configured to be more or less sensitive (e.g., motion sensor). It provides IAS Zone clients with the range of sensitivity levels that
        /// are supported so they MAY be presented to the user for configuration.
        /// 
        /// The values 0x00 and 0x01 are reserved because a device that has zero or one sensitivity level SHOULD NOT support this attribute because no
        /// configuration of the IAS Zone server’s sensitivity level is possible.
        /// 
        /// The meaning of each sensitivity level is manufacturer-specific. However, the sensitivity level of the IAS Zone server SHALL become more
        /// sensitive as they ascend. For example, if the server supports three sen- sitivity levels, then the value of this attribute would be 0x03
        /// where 0x03 is more sensitive than 0x02, which is more sensitive than 0x01.
        /// </summary>
        public const ushort ATTR_NUMBEROFZONESENSITIVITYLEVELSSUPPORTED = 0x0012;

        /// <summary>
        /// Allows an IAS Zone client to query and configure the IAS Zone server’s sensitivity level. Please see
        /// NumberOfZoneSensitivityLevelsSupported Attribute for more detail on how to interpret this attribute.
        /// 
        /// The default value 0x00 is the device’s default sensitivity level as configured by the manufacturer. It MAY correspond to the same
        /// sensitivity as another value in the NumberOfZoneSensitivityLevelsSupported, but this is the default sensitivity to be used if the
        /// CurrentZoneSensitivityLevel attribute is not otherwise configured by an IAS Zone client.
        /// </summary>
        public const ushort ATTR_CURRENTZONESENSITIVITYLEVEL = 0x0013;


        // Attribute initialisation
        protected override Dictionary<ushort, ZclAttribute> InitializeAttributes()
        {
            Dictionary<ushort, ZclAttribute> attributeMap = new Dictionary<ushort, ZclAttribute>(7);

            ZclClusterType iASZone = ZclClusterType.GetValueById(ClusterType.IAS_ZONE);

            attributeMap.Add(ATTR_ZONESTATE, new ZclAttribute(iASZone, ATTR_ZONESTATE, "ZoneState", ZclDataType.Get(DataType.ENUMERATION_8_BIT), true, true, false, false));
            attributeMap.Add(ATTR_ZONETYPE, new ZclAttribute(iASZone, ATTR_ZONETYPE, "ZoneType", ZclDataType.Get(DataType.ENUMERATION_16_BIT), true, true, false, false));
            attributeMap.Add(ATTR_ZONESTATUS, new ZclAttribute(iASZone, ATTR_ZONESTATUS, "ZoneStatus", ZclDataType.Get(DataType.BITMAP_16_BIT), true, true, false, false));
            attributeMap.Add(ATTR_IASCIEADDRESS, new ZclAttribute(iASZone, ATTR_IASCIEADDRESS, "IASCIEAddress", ZclDataType.Get(DataType.IEEE_ADDRESS), true, true, true, false));
            attributeMap.Add(ATTR_ZONEID, new ZclAttribute(iASZone, ATTR_ZONEID, "ZoneID", ZclDataType.Get(DataType.UNSIGNED_8_BIT_INTEGER), true, true, true, false));
            attributeMap.Add(ATTR_NUMBEROFZONESENSITIVITYLEVELSSUPPORTED, new ZclAttribute(iASZone, ATTR_NUMBEROFZONESENSITIVITYLEVELSSUPPORTED, "NumberOfZoneSensitivityLevelsSupported", ZclDataType.Get(DataType.UNSIGNED_8_BIT_INTEGER), false, true, false, false));
            attributeMap.Add(ATTR_CURRENTZONESENSITIVITYLEVEL, new ZclAttribute(iASZone, ATTR_CURRENTZONESENSITIVITYLEVEL, "CurrentZoneSensitivityLevel", ZclDataType.Get(DataType.UNSIGNED_8_BIT_INTEGER), false, true, true, false));

            return attributeMap;
        }

        /// <summary>
        /// Default constructor to create a IAS Zone cluster.
        ///
        /// <param name ="zigbeeEndpoint">The ZigBeeEndpoint</param>
        /// </summary>
        public ZclIASZoneCluster(ZigBeeEndpoint zigbeeEndpoint)
            : base(zigbeeEndpoint, CLUSTER_ID, CLUSTER_NAME)
        {
        }


        /// <summary>
        /// Get the ZoneState attribute [attribute ID0].
        ///
        /// The Zone State attribute defines if the device is currently enrolled with a CIE or not.
        ///
        /// The attribute is of type byte.
        ///
        /// The implementation of this attribute by a device is MANDATORY
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> GetZoneStateAsync()
        {
            return Read(_attributes[ATTR_ZONESTATE]);
        }

        /// <summary>
        /// Synchronously Get the ZoneState attribute [attribute ID0].
        ///
        /// The Zone State attribute defines if the device is currently enrolled with a CIE or not.
        ///
        /// The attribute is of type byte.
        ///
        /// The implementation of this attribute by a device is MANDATORY
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public byte GetZoneState(long refreshPeriod)
        {
            if (_attributes[ATTR_ZONESTATE].IsLastValueCurrent(refreshPeriod))
            {
                return (byte)_attributes[ATTR_ZONESTATE].LastValue;
            }

            return (byte)ReadSync(_attributes[ATTR_ZONESTATE]);
        }


        /// <summary>
        /// Get the ZoneType attribute [attribute ID1].
        ///
        /// The Zone Type dictates the meaning of Alarm1 and Alarm2 bits of the ZoneStatus attribute
        ///
        /// The attribute is of type ushort.
        ///
        /// The implementation of this attribute by a device is MANDATORY
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> GetZoneTypeAsync()
        {
            return Read(_attributes[ATTR_ZONETYPE]);
        }

        /// <summary>
        /// Synchronously Get the ZoneType attribute [attribute ID1].
        ///
        /// The Zone Type dictates the meaning of Alarm1 and Alarm2 bits of the ZoneStatus attribute
        ///
        /// The attribute is of type ushort.
        ///
        /// The implementation of this attribute by a device is MANDATORY
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public ushort GetZoneType(long refreshPeriod)
        {
            if (_attributes[ATTR_ZONETYPE].IsLastValueCurrent(refreshPeriod))
            {
                return (ushort)_attributes[ATTR_ZONETYPE].LastValue;
            }

            return (ushort)ReadSync(_attributes[ATTR_ZONETYPE]);
        }


        /// <summary>
        /// Get the ZoneStatus attribute [attribute ID2].
        ///
        /// The ZoneStatus attribute is a bit map. Each bit defines the state of an alarm.
        ///
        /// The attribute is of type ushort.
        ///
        /// The implementation of this attribute by a device is MANDATORY
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> GetZoneStatusAsync()
        {
            return Read(_attributes[ATTR_ZONESTATUS]);
        }

        /// <summary>
        /// Synchronously Get the ZoneStatus attribute [attribute ID2].
        ///
        /// The ZoneStatus attribute is a bit map. Each bit defines the state of an alarm.
        ///
        /// The attribute is of type ushort.
        ///
        /// The implementation of this attribute by a device is MANDATORY
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public ushort GetZoneStatus(long refreshPeriod)
        {
            if (_attributes[ATTR_ZONESTATUS].IsLastValueCurrent(refreshPeriod))
            {
                return (ushort)_attributes[ATTR_ZONESTATUS].LastValue;
            }

            return (ushort)ReadSync(_attributes[ATTR_ZONESTATUS]);
        }


        /// <summary>
        /// Set the IASCIEAddress attribute [attribute ID16].
        ///
        /// The IAS_CIE_Address attribute specifies the address that commands generated by
        /// the server shall be sent to. All commands received by the server must also come
        /// from this address.
        /// 
        /// It is up to the zone's specific implementation to permit or deny change (write) of
        /// this attribute at specific times. Also, it is up to the zone's specific implementation
        /// to implement some auto-detect for the CIE (example: by requesting the ZigBee
        /// cluster discovery service to locate a Zone Server cluster.) or require the
        /// intervention of a CT in order to configure this attribute during installation.
        ///
        /// The attribute is of type IeeeAddress.
        ///
        /// The implementation of this attribute by a device is MANDATORY
        ///
        /// <param name="iASCIEAddress">The IeeeAddress attribute value to be set</param>
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> SetIASCIEAddress(object value)
        {
            return Write(_attributes[ATTR_IASCIEADDRESS], value);
        }


        /// <summary>
        /// Get the IASCIEAddress attribute [attribute ID16].
        ///
        /// The IAS_CIE_Address attribute specifies the address that commands generated by
        /// the server shall be sent to. All commands received by the server must also come
        /// from this address.
        /// 
        /// It is up to the zone's specific implementation to permit or deny change (write) of
        /// this attribute at specific times. Also, it is up to the zone's specific implementation
        /// to implement some auto-detect for the CIE (example: by requesting the ZigBee
        /// cluster discovery service to locate a Zone Server cluster.) or require the
        /// intervention of a CT in order to configure this attribute during installation.
        ///
        /// The attribute is of type IeeeAddress.
        ///
        /// The implementation of this attribute by a device is MANDATORY
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> GetIASCIEAddressAsync()
        {
            return Read(_attributes[ATTR_IASCIEADDRESS]);
        }

        /// <summary>
        /// Synchronously Get the IASCIEAddress attribute [attribute ID16].
        ///
        /// The IAS_CIE_Address attribute specifies the address that commands generated by
        /// the server shall be sent to. All commands received by the server must also come
        /// from this address.
        /// 
        /// It is up to the zone's specific implementation to permit or deny change (write) of
        /// this attribute at specific times. Also, it is up to the zone's specific implementation
        /// to implement some auto-detect for the CIE (example: by requesting the ZigBee
        /// cluster discovery service to locate a Zone Server cluster.) or require the
        /// intervention of a CT in order to configure this attribute during installation.
        ///
        /// The attribute is of type IeeeAddress.
        ///
        /// The implementation of this attribute by a device is MANDATORY
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public IeeeAddress GetIASCIEAddress(long refreshPeriod)
        {
            if (_attributes[ATTR_IASCIEADDRESS].IsLastValueCurrent(refreshPeriod))
            {
                return (IeeeAddress)_attributes[ATTR_IASCIEADDRESS].LastValue;
            }

            return (IeeeAddress)ReadSync(_attributes[ATTR_IASCIEADDRESS]);
        }


        /// <summary>
        /// Set the ZoneID attribute [attribute ID17].
        ///
        /// A unique reference number allocated by the CIE at zone enrollment time.
        /// 
        /// Used by IAS devices to reference specific zones when communicating with the CIE. The ZoneID of each zone stays fixed until that zone is
        /// unenrolled.
        ///
        /// The attribute is of type byte.
        ///
        /// The implementation of this attribute by a device is MANDATORY
        ///
        /// <param name="zoneID">The byte attribute value to be set</param>
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> SetZoneID(object value)
        {
            return Write(_attributes[ATTR_ZONEID], value);
        }


        /// <summary>
        /// Get the ZoneID attribute [attribute ID17].
        ///
        /// A unique reference number allocated by the CIE at zone enrollment time.
        /// 
        /// Used by IAS devices to reference specific zones when communicating with the CIE. The ZoneID of each zone stays fixed until that zone is
        /// unenrolled.
        ///
        /// The attribute is of type byte.
        ///
        /// The implementation of this attribute by a device is MANDATORY
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> GetZoneIDAsync()
        {
            return Read(_attributes[ATTR_ZONEID]);
        }

        /// <summary>
        /// Synchronously Get the ZoneID attribute [attribute ID17].
        ///
        /// A unique reference number allocated by the CIE at zone enrollment time.
        /// 
        /// Used by IAS devices to reference specific zones when communicating with the CIE. The ZoneID of each zone stays fixed until that zone is
        /// unenrolled.
        ///
        /// The attribute is of type byte.
        ///
        /// The implementation of this attribute by a device is MANDATORY
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public byte GetZoneID(long refreshPeriod)
        {
            if (_attributes[ATTR_ZONEID].IsLastValueCurrent(refreshPeriod))
            {
                return (byte)_attributes[ATTR_ZONEID].LastValue;
            }

            return (byte)ReadSync(_attributes[ATTR_ZONEID]);
        }


        /// <summary>
        /// Get the NumberOfZoneSensitivityLevelsSupported attribute [attribute ID18].
        ///
        /// Provides the total number of sensitivity levels supported by the IAS Zone server. The purpose of this attribute is to support devices that
        /// can be configured to be more or less sensitive (e.g., motion sensor). It provides IAS Zone clients with the range of sensitivity levels that
        /// are supported so they MAY be presented to the user for configuration.
        /// 
        /// The values 0x00 and 0x01 are reserved because a device that has zero or one sensitivity level SHOULD NOT support this attribute because no
        /// configuration of the IAS Zone server’s sensitivity level is possible.
        /// 
        /// The meaning of each sensitivity level is manufacturer-specific. However, the sensitivity level of the IAS Zone server SHALL become more
        /// sensitive as they ascend. For example, if the server supports three sen- sitivity levels, then the value of this attribute would be 0x03
        /// where 0x03 is more sensitive than 0x02, which is more sensitive than 0x01.
        ///
        /// The attribute is of type byte.
        ///
        /// The implementation of this attribute by a device is OPTIONAL
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> GetNumberOfZoneSensitivityLevelsSupportedAsync()
        {
            return Read(_attributes[ATTR_NUMBEROFZONESENSITIVITYLEVELSSUPPORTED]);
        }

        /// <summary>
        /// Synchronously Get the NumberOfZoneSensitivityLevelsSupported attribute [attribute ID18].
        ///
        /// Provides the total number of sensitivity levels supported by the IAS Zone server. The purpose of this attribute is to support devices that
        /// can be configured to be more or less sensitive (e.g., motion sensor). It provides IAS Zone clients with the range of sensitivity levels that
        /// are supported so they MAY be presented to the user for configuration.
        /// 
        /// The values 0x00 and 0x01 are reserved because a device that has zero or one sensitivity level SHOULD NOT support this attribute because no
        /// configuration of the IAS Zone server’s sensitivity level is possible.
        /// 
        /// The meaning of each sensitivity level is manufacturer-specific. However, the sensitivity level of the IAS Zone server SHALL become more
        /// sensitive as they ascend. For example, if the server supports three sen- sitivity levels, then the value of this attribute would be 0x03
        /// where 0x03 is more sensitive than 0x02, which is more sensitive than 0x01.
        ///
        /// The attribute is of type byte.
        ///
        /// The implementation of this attribute by a device is OPTIONAL
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public byte GetNumberOfZoneSensitivityLevelsSupported(long refreshPeriod)
        {
            if (_attributes[ATTR_NUMBEROFZONESENSITIVITYLEVELSSUPPORTED].IsLastValueCurrent(refreshPeriod))
            {
                return (byte)_attributes[ATTR_NUMBEROFZONESENSITIVITYLEVELSSUPPORTED].LastValue;
            }

            return (byte)ReadSync(_attributes[ATTR_NUMBEROFZONESENSITIVITYLEVELSSUPPORTED]);
        }


        /// <summary>
        /// Set the CurrentZoneSensitivityLevel attribute [attribute ID19].
        ///
        /// Allows an IAS Zone client to query and configure the IAS Zone server’s sensitivity level. Please see
        /// NumberOfZoneSensitivityLevelsSupported Attribute for more detail on how to interpret this attribute.
        /// 
        /// The default value 0x00 is the device’s default sensitivity level as configured by the manufacturer. It MAY correspond to the same
        /// sensitivity as another value in the NumberOfZoneSensitivityLevelsSupported, but this is the default sensitivity to be used if the
        /// CurrentZoneSensitivityLevel attribute is not otherwise configured by an IAS Zone client.
        ///
        /// The attribute is of type byte.
        ///
        /// The implementation of this attribute by a device is OPTIONAL
        ///
        /// <param name="currentZoneSensitivityLevel">The byte attribute value to be set</param>
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> SetCurrentZoneSensitivityLevel(object value)
        {
            return Write(_attributes[ATTR_CURRENTZONESENSITIVITYLEVEL], value);
        }


        /// <summary>
        /// Get the CurrentZoneSensitivityLevel attribute [attribute ID19].
        ///
        /// Allows an IAS Zone client to query and configure the IAS Zone server’s sensitivity level. Please see
        /// NumberOfZoneSensitivityLevelsSupported Attribute for more detail on how to interpret this attribute.
        /// 
        /// The default value 0x00 is the device’s default sensitivity level as configured by the manufacturer. It MAY correspond to the same
        /// sensitivity as another value in the NumberOfZoneSensitivityLevelsSupported, but this is the default sensitivity to be used if the
        /// CurrentZoneSensitivityLevel attribute is not otherwise configured by an IAS Zone client.
        ///
        /// The attribute is of type byte.
        ///
        /// The implementation of this attribute by a device is OPTIONAL
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> GetCurrentZoneSensitivityLevelAsync()
        {
            return Read(_attributes[ATTR_CURRENTZONESENSITIVITYLEVEL]);
        }

        /// <summary>
        /// Synchronously Get the CurrentZoneSensitivityLevel attribute [attribute ID19].
        ///
        /// Allows an IAS Zone client to query and configure the IAS Zone server’s sensitivity level. Please see
        /// NumberOfZoneSensitivityLevelsSupported Attribute for more detail on how to interpret this attribute.
        /// 
        /// The default value 0x00 is the device’s default sensitivity level as configured by the manufacturer. It MAY correspond to the same
        /// sensitivity as another value in the NumberOfZoneSensitivityLevelsSupported, but this is the default sensitivity to be used if the
        /// CurrentZoneSensitivityLevel attribute is not otherwise configured by an IAS Zone client.
        ///
        /// The attribute is of type byte.
        ///
        /// The implementation of this attribute by a device is OPTIONAL
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public byte GetCurrentZoneSensitivityLevel(long refreshPeriod)
        {
            if (_attributes[ATTR_CURRENTZONESENSITIVITYLEVEL].IsLastValueCurrent(refreshPeriod))
            {
                return (byte)_attributes[ATTR_CURRENTZONESENSITIVITYLEVEL].LastValue;
            }

            return (byte)ReadSync(_attributes[ATTR_CURRENTZONESENSITIVITYLEVEL]);
        }


        /// <summary>
        /// The Zone Enroll Response
        ///
        /// <param name="enrollResponseCode"><see cref="byte"/> Enroll response code</param>
        /// <param name="zoneID"><see cref="byte"/> Zone ID</param>
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> ZoneEnrollResponse(byte enrollResponseCode, byte zoneID)
        {
            ZoneEnrollResponse command = new ZoneEnrollResponse();

            // Set the fields
            command.EnrollResponseCode = enrollResponseCode;
            command.ZoneID = zoneID;

            return Send(command);
        }

        /// <summary>
        /// The Initiate Normal Operation Mode Command
        ///
        /// Used to tell the IAS Zone server to commence normal operation mode.
        /// <br>
        /// Upon receipt, the IAS Zone server SHALL commence normal operational mode.
        /// <br>
        /// Any configurations and changes made (e.g., CurrentZoneSensitivityLevel attribute) to the IAS Zone server SHALL be retained.
        /// <br>
        /// Upon commencing normal operation mode, the IAS Zone server SHALL send a Zone Status Change Notification command updating the ZoneStatus
        /// attribute Test bit to zero (i.e., “operation mode”).
        ///
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> InitiateNormalOperationModeCommand()
        {
            InitiateNormalOperationModeCommand command = new InitiateNormalOperationModeCommand();

            return Send(command);
        }

        /// <summary>
        /// The Initiate Test Mode Command
        ///
        /// Certain IAS Zone servers MAY have operational configurations that could be configured OTA or locally on the device. This command enables
        /// them to be remotely placed into a test mode so that the user or installer MAY configure their field of view, sensitivity, and other
        /// operational parameters. They MAY also verify the placement and proper operation of the IAS Zone server, which MAY have been placed in a
        /// difficult to reach location (i.e., making a physical input on the device impractical to trigger).
        /// <br>
        /// Another use case for this command is large deployments, especially commercial and industrial, where placing the entire IAS system into
        /// test mode instead of a single IAS Zone server is infeasible due to the vulnerabilities that might arise. This command enables only a single
        /// IAS Zone server to be placed into test mode.
        /// <br>
        /// The biggest limitation of this command is that most IAS Zone servers today are battery-powered sleepy nodes that cannot reliably receive
        /// commands. However, implementers MAY decide to program an IAS Zone server by factory default to maintain a limited duration of normal
        /// polling upon initialization/joining to a new network. Some IAS Zone servers MAY also have AC mains power and are able to receive commands.
        /// Some types of IAS Zone servers that MAY benefit from this command are: motion sensors and fire sensor/smoke alarm listeners (i.e., a device
        /// that listens for a non-communicating fire sensor to alarm and communicates this to the IAS CIE).
        ///
        /// <param name="testModeDuration"><see cref="byte"/> Test Mode Duration</param>
        /// <param name="currentZoneSensitivityLevel"><see cref="byte"/> Current Zone Sensitivity Level</param>
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> InitiateTestModeCommand(byte testModeDuration, byte currentZoneSensitivityLevel)
        {
            InitiateTestModeCommand command = new InitiateTestModeCommand();

            // Set the fields
            command.TestModeDuration = testModeDuration;
            command.CurrentZoneSensitivityLevel = currentZoneSensitivityLevel;

            return Send(command);
        }

        /// <summary>
        /// The Zone Status Change Notification Command
        ///
        /// <param name="zoneStatus"><see cref="ushort"/> Zone Status</param>
        /// <param name="extendedStatus"><see cref="byte"/> Extended Status</param>
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> ZoneStatusChangeNotificationCommand(ushort zoneStatus, byte extendedStatus)
        {
            ZoneStatusChangeNotificationCommand command = new ZoneStatusChangeNotificationCommand();

            // Set the fields
            command.ZoneStatus = zoneStatus;
            command.ExtendedStatus = extendedStatus;

            return Send(command);
        }

        /// <summary>
        /// The Zone Enroll Request Command
        ///
        /// The Zone Enroll Request command is generated when a device embodying the Zone server cluster wishes
        /// to be  enrolled as an active  alarm device. It  must do this immediately it has joined the network
        /// (during commissioning).
        ///
        /// <param name="zoneType"><see cref="ushort"/> Zone Type</param>
        /// <param name="manufacturerCode"><see cref="ushort"/> Manufacturer Code</param>
        /// <returns>The Task<CommandResult> command result Task</returns>
        /// </summary>
        public Task<CommandResult> ZoneEnrollRequestCommand(ushort zoneType, ushort manufacturerCode)
        {
            ZoneEnrollRequestCommand command = new ZoneEnrollRequestCommand();

            // Set the fields
            command.ZoneType = zoneType;
            command.ManufacturerCode = manufacturerCode;

            return Send(command);
        }

        public override ZclCommand GetCommandFromId(int commandId)
        {
            switch (commandId)
            {
                case 0: // ZONE_ENROLL_RESPONSE
                    return new ZoneEnrollResponse();
                case 1: // INITIATE_NORMAL_OPERATION_MODE_COMMAND
                    return new InitiateNormalOperationModeCommand();
                case 2: // INITIATE_TEST_MODE_COMMAND
                    return new InitiateTestModeCommand();
                    default:
                        return null;
            }
        }

        public ZclCommand getResponseFromId(int commandId)
        {
            switch (commandId)
            {
                case 0: // ZONE_STATUS_CHANGE_NOTIFICATION_COMMAND
                    return new ZoneStatusChangeNotificationCommand();
                case 1: // ZONE_ENROLL_REQUEST_COMMAND
                    return new ZoneEnrollRequestCommand();
                    default:
                        return null;
            }
        }
    }
}
